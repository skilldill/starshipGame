var P=Object.defineProperty;var R=(i,e,t)=>e in i?P(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>(R(i,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function H(i){switch(i){case"1":return"#fff";case"2":return"red";case"3":return"orange";case"4":return"#70655e";case"5":return"#5b6ce3";default:return"#fff"}}function A(i){return Math.floor(Math.random()*i)}class v{constructor(e,t,s,r){c(this,"asteroids",[]);c(this,"generateAsteroids",()=>{for(let e=0;e<this.sceneHeight-40;e++)for(let t=0;t<this.sceneWidth*10;t++)A(5e4)===10&&this.asteroids.push({x:t+this.sceneWidth,y:e})});c(this,"renderAsteroid",(e,t,s=1)=>{for(let r=0;r<this.template.length;r++){const o=this.template[r];for(let d=0;d<o.length;d++){const h=o[d];h!=="0"&&(this.ctx.fillStyle=H(h),this.ctx.fillRect(e+d*s,t+r*s,1*s,1*s))}}});c(this,"renderAsteroids",()=>{this.asteroids.forEach(({x:e,y:t})=>{e>-20&&this.renderAsteroid(e,t,3)})});c(this,"moveAsteroids",e=>{this.asteroids=this.asteroids.map(({x:t,y:s})=>(t<-20&&e(),t>-23?{x:t-2,y:s}:{x:this.sceneWidth+20,y:s})),this.renderAsteroids()});this.ctx=e,this.template=t,this.sceneWidth=s,this.sceneHeight=r,this.generateAsteroids()}}function L(i,e){return e/(i/100)}class W{constructor(e,t,s,r,o){c(this,"renderHP",()=>{const e=L(this.maxHP,this.currentHP);e>33&&(this.ctx.fillStyle="orange"),e>66&&(this.ctx.fillStyle="green"),e<33&&(this.ctx.fillStyle="red"),this.ctx.fillRect(this.sceneWidth-250,this.sceneHeight-70,this.currentHP*2,20)});c(this,"downHP",(e=1)=>{if(this.currentHP-=e,this.currentHP<=0)return this.onGameOver();this.currentHP>0&&this.renderHP()});this.ctx=e,this.maxHP=t,this.currentHP=t,this.sceneHeight=r,this.sceneWidth=s,this.renderHP(),this.onGameOver=o}}class K{constructor(e,t,s){c(this,"shots",[]);c(this,"addShot",(e,t)=>{t>0&&t<this.sceneHeight&&e<this.sceneWidth&&this.shots.push({x:e,y:t}),this.shots.sort((s,r)=>s.y-r.y)});c(this,"renderShots",()=>{this.ctx.fillStyle="yellow",this.shots.forEach(e=>{e.x<this.sceneWidth&&this.ctx.fillRect(e.x,e.y,6,2)})});c(this,"moveShots",e=>{this.shots=this.shots.map(t=>{if(t.x<this.sceneWidth){const s={...t,x:t.x+12};return e(s)?{...t,x:this.sceneWidth+10}:s}return t}),this.renderShots()});this.ctx=e,this.sceneWidth=t,this.sceneHeight=s}}class I{constructor(e,t,s){c(this,"stars",[]);c(this,"generateStars",()=>{for(let e=0;e<this.sceneWidth;e+=2)for(let t=0;t<this.sceneWidth;t+=2){const s=A(100);(s===100||s===10)&&this.stars.push({x:e,y:t})}});c(this,"renderStars",()=>{this.ctx.fillStyle="#fff",this.stars.forEach(e=>{this.ctx.fillRect(e.x,e.y,1,1)})});c(this,"moveStars",()=>{this.stars=this.stars.map(e=>{const t=e.x-1;return t<0?{...e,x:this.sceneWidth}:{...e,x:t}}),this.renderStars()});this.ctx=e,this.sceneWidth=t,this.sceneHeight=s,this.generateStars(),this.renderStars()}}class O{constructor(e,t,s,r){c(this,"render",(e,t,s=2,r=1)=>{for(let o=0;o<this.template.length;o++){const d=this.template[o];for(let h=0;h<d.length;h++){const l=d[h];l!=="0"&&(this.ctx.fillStyle=H(l),this.ctx.fillRect(e+h*s,t+o*s,1*s,1*s))}}});this.ctx=e,this.template=t,this.startX=s,this.startY=r,this.render(s,r)}}const B=[["0","0","4","4","4","4","0","0"],["0","4","4","4","4","4","4","0"],["4","3","4","4","4","3","4","3"],["4","4","4","3","4","4","4","4"],["4","4","4","4","4","3","4","4"],["0","3","4","4","4","4","4","0"],["0","0","4","3","4","4","4","0"]],f=800,u=600;function D(i,e,t,s=100){let r=0;function o(d=0){const h=d-r,l=t();h>=s&&i.forEach(w=>w(e,l)),requestAnimationFrame(o)}return o}const g=[["0","0","0","5","1","1","1","2","0","0","0","0"],["0","0","0","1","1","0","0","0","0","0","0","0"],["0","0","0","1","1","0","0","0","0","0","0","0"],["0","0","0","1","1","1","1","0","0","0","0","0"],["0","3","3","5","5","1","1","1","1","1","1","0"],["3","3","3","5","5","1","1","5","5","5","1","1"],["0","3","3","5","5","1","1","1","1","1","1","0"],["0","0","0","1","1","1","1","0","0","0","0","0"],["0","0","0","1","1","0","0","0","0","0","0","0"],["0","0","0","1","1","0","0","0","0","0","0","0"],["0","0","0","5","1","1","1","2","0","0","0","0"]],x=document.getElementById("controller"),b=document.getElementById("gameOverBlock"),C=document.getElementById("restartButton"),T=document.getElementById("scoresDisplay"),S=document.getElementById("gameScene"),a=S.getContext("2d");S.addEventListener("click",()=>{x.focus()});C.addEventListener("click",()=>{window.location.reload()});function X(i){i.fillStyle="#000",i.fillRect(0,0,f,u)}let E=0,n={posX:100,posY:200,pressedHorizontalKey:"",pressedVerticalKey:""};function V(){switch(n.pressedVerticalKey){case"ArrowDown":n={...n,posY:n.posY+8};break;case"ArrowUp":n={...n,posY:n.posY-8};break}switch(n.pressedHorizontalKey){case"ArrowRight":n={...n,posX:n.posX+3};break;case"ArrowLeft":n={...n,posX:n.posX-3};break}return n}const _=i=>e=>{i[e.code]()},z=i=>e=>{var t;(t=i[e.code])==null||t.call(i)},U=()=>{b.style.opacity=1,S.style.display="none",T.innerText=`Сбито астеройдов ${E}`};function Y(){const i=new I(a,f,u),e=new K(a,f,u),t=new O(a,g,100,u/2-(g-1)/2),s=new v(a,B,f,u),r=new W(a,100,f,u,U),o={ArrowUp:()=>{n={...n,pressedVerticalKey:"ArrowUp"}},ArrowDown:()=>{n={...n,pressedVerticalKey:"ArrowDown"}},ArrowLeft:()=>{n={...n,pressedHorizontalKey:"ArrowLeft"}},ArrowRight:()=>{n={...n,pressedHorizontalKey:"ArrowRight"}},Space:()=>{e.addShot(n.posX+g[0].length,n.posY+0),e.addShot(n.posX+g[0].length,n.posY+30)}},d={ArrowUp:()=>{n={...n,pressedVerticalKey:""}},ArrowDown:()=>{n={...n,pressedVerticalKey:""}},ArrowLeft:()=>{n={...n,pressedHorizontalKey:""}},ArrowRight:()=>{n={...n,pressedHorizontalKey:""}}};x.addEventListener("keydown",_(o)),x.addEventListener("keyup",z(d));const h=p=>{x.focus();const m=s.asteroids.findIndex(y=>p.x>=y.x&&p.x<=y.x+100&&p.y>=y.y&&p.y<=y.y+40);return m>-1?(s.asteroids[m].x=f*10,E+=1,!0):!1},l=()=>{r.downHP(2)};let w=[X,i.moveStars,(p,m)=>t.render(m.posX,m.posY,3),()=>e.moveShots(h),()=>s.moveAsteroids(l),r.renderHP];D(w,a,V,100)()}Y();
